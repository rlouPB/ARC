<apex:page renderAs="pdf" applyBodyTag="false" controller="CaseAbstractPresentationPDFController" action="{!init}">
    <head>
        <style type="text/css" media="print">
            @page {
                padding-top: 126px;
                @top-center {
                    content: element(header);
                }
                @bottom-left {
                    content: element(footer);
                }
            }
            div.header {
                padding: 10px;
                padding-top: 0.25in;
                position: running(header);
            }
            div.footer {
                display: block;
                padding: 5px;
                padding-bottom: 0.25in;
                position: running(footer);
                font-size: small;
            }
            .pagenumber:before {
                content: counter(page);
            }
            .pagecount:before {
                content: counter(pages);
            }
            body{
                font-family: "Arial", "Helvetica", sans-serif;
            }
            .red-border{
                border: 1px solid red;
            }
            .red{
                color: red;
            }
            .center-text{
                text-align: center;
            }
            .slim-margin{
                margin: 5px;
            }
            .text-align-right{
                text-align: right;
            }
            .logo-padding{
                padding: 5px 20px 6px;
            }
            .float-left{
                float: left;
            }
            .float-right{
                float: right;
                margin-top: 35px;
            }
            .logo-image{
                width: 350px;
                position: relative;
                left: -8px;
            }
            .bold{
                font-weight: 700;
            }
            .extra-space{
                height: 25px;
            }
            .section-header {
                font-size: 2em;
                font-weight: 700;
                margin-top: 20px;
            }
            .item-section-header {
                font-size: 1.5em;
                font-weight: 700;
                margin-top: 20px;
            }
            h1 {
                font-size: 1.2em;
                font-weight: 500;
            }
            hr.rounded {
                border-top: 8px solid #bbb;
                border-radius: 5px;
            }
            .medical-record-item:nth-of-type(odd){
            background-color: lightgrey;
            }
            .medical-record-item:nth-of-type(even){
            background-color: white;
            }
            .answer {
                margin-top : 2px
            }
            .slds-text-heading_large {
                font-size: 1.8em;
                font-weight: 600;
            }
            .slds-m-bottom_large {
                margin-bottom: 10px;
            }
            /* ARC-2508: remove the extra line when rendering <br/> in PDF generated by rich text editor */
            .case-abstract-section-item p br {
                display: none;
            }
        </style>
    </head>
    <div class="header">
        <div class="red-border center-text">
            <p class="red slim-margin bold">{!$Label.ARC_Medical_Record_Disclaimer}</p>
        </div>
        <div class="float-left logo-padding"><img alt="" class="logo-image" src="{!$Resource.Riggs_Logo_Medical_Records}" /><br />
            <span style="font-size:16px;">{!$Label.ARC_Address}</span><br/>
           
        </div>
        
        <!--
            {!caseAbstract.record.Name}
        -->
        <div class="float-right text-align-right"><span class="bold">{!caseAbstract.record.Admission__r.Patient_Account__r.Name}</span> <br />
            <span>File No.&nbsp;{!caseAbstract.record.Admission__r.Patient_Account__r.Medical_Record_Number__c}</span><br />
            <span>Date Admitted&nbsp;<apex:outputText value="{0,date,MM/dd/yyyy}"> <apex:param value="{!caseAbstract.admission.Admit_Date__c}" /> </apex:outputText></span><br />
            <apex:outputPanel layout="block" rendered="{!caseAbstract.record.Admission__r.Patient_Account__r.Date_of_Birth__c != null}">
                <span>Birthdate&nbsp;<apex:outputText value="{0,date,MM/dd/yyyy}"> <apex:param value="{!caseAbstract.record.Admission__r.Patient_Account__r.Date_of_Birth__c}" /> </apex:outputText></span><br/>
            </apex:outputPanel>
            
        </div>
        
            
        
    </div>
    <div class="footer">
        
        <div><span class="pagenumber"/>/<span class="pagecount"/> <span> &nbsp; &nbsp;Generated by {!caseAbstract.presentation.generatedBy} on {!caseAbstract.presentation.generatedDateTimeString}</span></div>
        
    </div>
    <div class="content">
        <apex:outputPanel layout="block" rendered="{!caseAbstract.record.Status__c != 'Finalized'}">
            <div class="slds-text-heading_large center-text slds-m-bottom_large">Latest Case Abstract Presentation</div>
        </apex:outputPanel>
        <apex:outputPanel layout="block" rendered="{!caseAbstract.record.Status__c == 'Finalized'}">
            <div class="slds-text-heading_large center-text slds-m-bottom_medium">Case Abstract Presentation</div>
            <div class="center-text slds-m-bottom_large">Finalized&nbsp;by&nbsp;{!caseAbstract.record.Finalized_By_Professional_Name__c}&nbsp;at&nbsp;<apex:outputText value="{!finalizedDateTimeString}"> </apex:outputText></div>
        </apex:outputPanel>
        <br/>
        <div class="slds-text-heading_large slds-m-left_small" >
            Case Abstract
        </div>
        <!--Test image... <img src="/sfc/servlet.shepherd/version/download/0682i000002zOfoAAE"/> -->

        <apex:repeat value="{!caseAbstract.sections}" var="section" id="theRepeat1">
            <!--apex:outputField value="{!section.record.itm_GenoGram__c}" /-->
            <apex:outputPanel layout="block" rendered="{!section.isCompleted}">
                <div class="item-section-header">
                    {!section.sectionMdt.Section_Number__c}&nbsp;{!section.sectionMdt.Title__c} 
                </div><br/>
                <apex:repeat value="{!section.items}" var="item" id="theRepeat1">
                    <!--{!item.sectionItemMdt.Source_Field_Name__c}-->
                    <!--apex:outputField value="{!section.record.itm_GenoGram__c}" /-->
                    <div class="case-abstract-section-item">
                        <apex:outputText value="{!item.sectionFieldValue}" id="theHTML" escape="false"/>
                    </div>
                    <apex:outputPanel layout="block" rendered="{!item.contentVersionId != null}">
                        <br/>
                        
                        <img src="/sfc/servlet.shepherd/version/renditionDownload?rendition=THUMB720BY480&versionId={!item.contentVersionId}"/>
                        <br/>
                    </apex:outputPanel>
                </apex:repeat>
                
            <div >
                    Completed By {!section.record.Completed_By_Professional_Name__c}&nbsp;at&nbsp;<apex:outputText value="{!section.completedDateTimeString}"> </apex:outputText>
            </div>
       
            </apex:outputPanel>
            <br/>
        </apex:repeat>
    </div>
</apex:page>